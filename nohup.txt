Creating csv
INFO:absl:force process is set to be true
INFO:absl:Processing the AISHELL subset train in /data/thchs30/data_thchs30
INFO:absl:Processing audio and transcript for train
INFO:absl:Successfully generated csv file examples/asr/thchs30/data/train.csv
INFO:absl:Finished processing AISHELL subset train
INFO:absl:force process is set to be true
INFO:absl:Processing the AISHELL subset dev in /data/thchs30/data_thchs30
INFO:absl:Processing audio and transcript for dev
INFO:absl:Successfully generated csv file examples/asr/thchs30/data/dev.csv
INFO:absl:Finished processing AISHELL subset dev
INFO:absl:force process is set to be true
INFO:absl:Processing the AISHELL subset test in /data/thchs30/data_thchs30
INFO:absl:Processing audio and transcript for test
INFO:absl:Successfully generated csv file examples/asr/thchs30/data/test.csv
INFO:absl:Finished processing AISHELL subset test
Computing cmvn
INFO:absl:hparams: [('batch_size', 8), ('ckpt', 'examples/asr/thchs30/ckpts/mpc'), ('cls', 'main'), ('dataset_builder', 'speech_dataset'), ('decode_config', None), ('devset_config', {'data_csv': 'examples/asr/thchs30/data/dev.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'input_length_range': [10, 8000]}), ('model', 'mpc'), ('model_config', {'return_encoder_output': False, 'num_filters': 512, 'd_model': 512, 'num_heads': 8, 'num_encoder_layers': 12, 'dff': 1280, 'rate': 0.1, 'chunk_size': 1, 'keep_probability': 0.8}), ('num_classes', 40), ('num_data_threads', 1), ('num_epochs', 50), ('optimizer', 'warmup_adam'), ('optimizer_config', {'d_model': 512, 'warmup_steps': 2000, 'k': 0.3}), ('pretrained_model', None), ('solver_config', {'clip_norm': 100, 'log_interval': 10, 'enable_tf_function': True}), ('solver_gpu', [0]), ('sorta_epoch', 5), ('summary_dir', 'examples/asr/aishell/ckpts/mpc/event'), ('testset_config', {'data_csv': 'examples/asr/thchs30/data/test.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'input_length_range': [10, 8000]}), ('trainset_config', {'data_csv': 'examples/asr/thchs30/data/train.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'input_length_range': [10, 8000]})]
INFO:absl:hparams: [('audio_config', {'type': 'Fbank', 'filterbank_channel_count': 40}), ('cls', <class 'athena.data.datasets.speech_set.SpeechDatasetBuilder'>), ('cmvn_file', 'examples/asr/thchs30/data/cmvn'), ('data_csv', 'examples/asr/thchs30/data/train.csv'), ('input_length_range', [10, 8000])]
INFO:absl:Loading data from examples/asr/thchs30/data/train.csv
INFO:absl:Loading data from examples/asr/thchs30/data/all.csv
2020-04-04 20:35:03.411596: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-04-04 20:35:04.227578: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-04 20:35:04.228070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:04:01.0
2020-04-04 20:35:04.228165: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-04 20:35:04.228606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:04:02.0
2020-04-04 20:35:04.228952: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-04-04 20:35:04.230380: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-04-04 20:35:04.231571: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-04-04 20:35:04.231890: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-04-04 20:35:04.233431: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-04-04 20:35:04.234523: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-04-04 20:35:04.234665: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /work20/luoxiaojie/cuda-10.0/lib64:/work20/luoxiaojie/kaldi/tools/liblbfgs-1.10/lib/.libs
2020-04-04 20:35:04.234678: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-04-04 20:35:04.235051: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-04-04 20:35:04.243316: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294605000 Hz
2020-04-04 20:35:04.244284: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f19701f0e0 executing computations on platform Host. Devices:
2020-04-04 20:35:04.244308: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
2020-04-04 20:35:04.505534: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-04 20:35:04.513397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-04-04 20:35:04.514151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f197062140 executing computations on platform CUDA. Devices:
2020-04-04 20:35:04.514179: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
2020-04-04 20:35:04.514186: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (1): Tesla V100-PCIE-16GB, Compute Capability 7.0
2020-04-04 20:35:04.514530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-04-04 20:35:04.514540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
INFO:absl:processing D13
  0%|          | 0/2789 [00:00<?, ?it/s]  0%|          | 1/2789 [00:00<34:01,  1.37it/s] 11%|█         | 297/2789 [00:00<21:17,  1.95it/s] 24%|██▎       | 656/2789 [00:00<12:45,  2.79it/s] 32%|███▏      | 884/2789 [00:01<07:58,  3.98it/s] 38%|███▊      | 1062/2789 [00:01<05:04,  5.68it/s] 49%|████▉     | 1380/2789 [00:01<02:53,  8.10it/s] 57%|█████▋    | 1588/2789 [00:01<01:43, 11.55it/s] 68%|██████▊   | 1907/2789 [00:01<00:53, 16.48it/s] 80%|███████▉  | 2230/2789 [00:01<00:23, 23.48it/s] 93%|█████████▎| 2607/2789 [00:01<00:05, 33.45it/s]100%|██████████| 2789/2789 [00:01<00:00, 1521.56it/s]
INFO:absl:processing A22
  0%|          | 0/2789 [00:00<?, ?it/s]  8%|▊         | 222/2789 [00:00<00:01, 2116.72it/s] 17%|█▋        | 476/2789 [00:00<00:01, 2194.49it/s] 27%|██▋       | 743/2789 [00:00<00:00, 2254.51it/s] 44%|████▍     | 1222/2789 [00:00<00:00, 2673.00it/s] 59%|█████▉    | 1656/2789 [00:00<00:00, 2963.02it/s] 70%|██████▉   | 1950/2789 [00:00<00:00, 2561.68it/s] 79%|███████▉  | 2214/2789 [00:00<00:00, 2513.79it/s] 90%|████████▉ | 2498/2789 [00:00<00:00, 2527.51it/s]100%|██████████| 2789/2789 [00:00<00:00, 2894.29it/s]
INFO:absl:processing D6
  0%|          | 0/2789 [00:00<?, ?it/s] 10%|█         | 282/2789 [00:00<00:00, 2518.22it/s] 20%|█▉        | 551/2789 [00:00<00:00, 2487.30it/s] 28%|██▊       | 791/2789 [00:00<00:00, 2436.30it/s] 37%|███▋      | 1036/2789 [00:00<00:00, 2411.50it/s] 44%|████▍     | 1240/2789 [00:00<00:00, 2252.92it/s] 51%|█████     | 1426/2789 [00:00<00:00, 1915.35it/s] 63%|██████▎   | 1762/2789 [00:00<00:00, 2172.12it/s] 79%|███████▉  | 2202/2789 [00:00<00:00, 2523.56it/s] 89%|████████▊ | 2475/2789 [00:01<00:00, 2116.10it/s] 97%|█████████▋| 2712/2789 [00:01<00:00, 1786.29it/s]100%|██████████| 2789/2789 [00:01<00:00, 2249.77it/s]
INFO:absl:processing A19
  0%|          | 0/2789 [00:00<?, ?it/s] 11%|█         | 313/2789 [00:00<00:00, 2818.61it/s] 24%|██▍       | 675/2789 [00:00<00:00, 2937.16it/s] 35%|███▌      | 980/2789 [00:00<00:00, 2916.89it/s] 42%|████▏     | 1176/2789 [00:00<00:00, 2251.66it/s] 54%|█████▍    | 1519/2789 [00:00<00:00, 2480.89it/s] 63%|██████▎   | 1744/2789 [00:00<00:00, 2265.55it/s] 75%|███████▍  | 2089/2789 [00:00<00:00, 2481.83it/s] 84%|████████▎ | 2335/2789 [00:00<00:00, 2401.47it/s] 92%|█████████▏| 2574/2789 [00:01<00:00, 2158.39it/s]100%|██████████| 2789/2789 [00:01<00:00, 2573.46it/s]
INFO:absl:processing D12
  0%|          | 0/2789 [00:00<?, ?it/s]  4%|▎         | 101/2789 [00:00<00:02, 944.76it/s]  9%|▊         | 238/2789 [00:00<00:02, 1021.87it/s] 11%|█         | 303/2789 [00:00<00:02, 866.27it/s]  15%|█▍        | 406/2789 [00:00<00:02, 899.48it/s] 18%|█▊        | 508/2789 [00:00<00:02, 919.26it/s] 22%|██▏       | 605/2789 [00:00<00:02, 916.26it/s] 25%|██▍       | 688/2789 [00:00<00:02, 801.15it/s] 29%|██▉       | 815/2789 [00:00<00:02, 882.23it/s] 35%|███▍      | 971/2789 [00:00<00:01, 993.62it/s] 39%|███▊      | 1075/2789 [00:01<00:01, 1006.25it/s] 42%|████▏     | 1179/2789 [00:01<00:01, 853.19it/s]  49%|████▉     | 1378/2789 [00:01<00:01, 1022.34it/s] 54%|█████▍    | 1501/2789 [00:01<00:01, 1070.20it/s] 58%|█████▊    | 1622/2789 [00:01<00:01, 1026.89it/s] 62%|██████▏   | 1735/2789 [00:01<00:01, 1043.08it/s] 70%|██████▉   | 1951/2789 [00:01<00:00, 1222.35it/s] 80%|███████▉  | 2218/2789 [00:01<00:00, 1443.93it/s] 86%|████████▌ | 2391/2789 [00:02<00:00, 1488.97it/s] 93%|█████████▎| 2584/2789 [00:02<00:00, 1565.02it/s]100%|██████████| 2789/2789 [00:02<00:00, 1288.74it/s]
INFO:absl:processing A32
  0%|          | 0/2789 [00:00<?, ?it/s]  4%|▍         | 123/2789 [00:00<00:02, 1121.09it/s] 13%|█▎        | 370/2789 [00:00<00:01, 1338.92it/s] 19%|█▉        | 537/2789 [00:00<00:01, 1402.59it/s] 26%|██▌       | 713/2789 [00:00<00:01, 1465.38it/s] 31%|███       | 859/2789 [00:00<00:01, 1423.47it/s] 35%|███▌      | 990/2789 [00:00<00:01, 1338.16it/s] 40%|████      | 1117/2789 [00:00<00:01, 1222.07it/s] 47%|████▋     | 1313/2789 [00:00<00:01, 1369.43it/s] 52%|█████▏    | 1454/2789 [00:00<00:01, 1309.27it/s] 58%|█████▊    | 1611/2789 [00:01<00:00, 1352.24it/s] 66%|██████▌   | 1846/2789 [00:01<00:00, 1519.74it/s] 72%|███████▏  | 2019/2789 [00:01<00:00, 1528.30it/s] 79%|███████▊  | 2192/2789 [00:01<00:00, 1536.91it/s] 88%|████████▊ | 2463/2789 [00:01<00:00, 1731.38it/s] 96%|█████████▌| 2675/2789 [00:01<00:00, 1786.76it/s]100%|██████████| 2789/2789 [00:01<00:00, 1688.34it/s]
INFO:absl:processing B11
  0%|          | 0/2789 [00:00<?, ?it/s]  5%|▍         | 132/2789 [00:00<00:02, 1192.22it/s]  9%|▊         | 241/2789 [00:00<00:02, 1124.15it/s] 17%|█▋        | 464/2789 [00:00<00:01, 1314.74it/s] 24%|██▍       | 672/2789 [00:00<00:01, 1452.69it/s] 29%|██▉       | 803/2789 [00:00<00:01, 1363.52it/s] 36%|███▌      | 998/2789 [00:00<00:01, 1497.95it/s] 42%|████▏     | 1173/2789 [00:00<00:01, 1563.64it/s] 48%|████▊     | 1329/2789 [00:00<00:01, 1231.30it/s] 54%|█████▍    | 1515/2789 [00:01<00:00, 1363.06it/s] 61%|██████    | 1689/2789 [00:01<00:00, 1446.73it/s] 66%|██████▌   | 1844/2789 [00:01<00:00, 1456.36it/s] 75%|███████▍  | 2081/2789 [00:01<00:00, 1626.61it/s] 81%|████████  | 2260/2789 [00:01<00:00, 1643.47it/s] 93%|█████████▎| 2596/2789 [00:01<00:00, 1911.81it/s]100%|██████████| 2789/2789 [00:01<00:00, 1637.41it/s]
INFO:absl:processing D8
  0%|          | 0/2789 [00:00<?, ?it/s] 10%|█         | 284/2789 [00:00<00:00, 2680.32it/s] 23%|██▎       | 646/2789 [00:00<00:00, 2869.81it/s] 37%|███▋      | 1041/2789 [00:00<00:00, 3054.49it/s] 58%|█████▊    | 1625/2789 [00:00<00:00, 3550.82it/s] 70%|██████▉   | 1951/2789 [00:00<00:00, 3142.59it/s] 84%|████████▍ | 2349/2789 [00:00<00:00, 3283.45it/s] 96%|█████████▌| 2671/2789 [00:00<00:00, 2946.16it/s]100%|██████████| 2789/2789 [00:00<00:00, 3115.58it/s]
INFO:absl:processing A8
  0%|          | 0/2789 [00:00<?, ?it/s] 10%|█         | 280/2789 [00:00<00:00, 2614.90it/s] 26%|██▌       | 717/2789 [00:00<00:00, 2931.50it/s] 40%|███▉      | 1110/2789 [00:00<00:00, 3079.89it/s] 48%|████▊     | 1340/2789 [00:00<00:00, 2661.45it/s] 66%|██████▌   | 1834/2789 [00:00<00:00, 3063.16it/s] 79%|███████▉  | 2199/2789 [00:00<00:00, 3156.34it/s] 95%|█████████▌| 2652/2789 [00:00<00:00, 3374.73it/s]100%|██████████| 2789/2789 [00:00<00:00, 3644.82it/s]
INFO:absl:processing A12
  0%|          | 0/2789 [00:00<?, ?it/s] 14%|█▍        | 400/2789 [00:00<00:00, 3751.11it/s] 32%|███▏      | 902/2789 [00:00<00:00, 3953.77it/s] 55%|█████▌    | 1545/2789 [00:00<00:00, 4434.65it/s] 67%|██████▋   | 1881/2789 [00:00<00:00, 3965.90it/s] 86%|████████▌ | 2405/2789 [00:00<00:00, 4210.52it/s]100%|██████████| 2789/2789 [00:00<00:00, 4523.80it/s]
INFO:absl:processing C21
  0%|          | 0/2789 [00:00<?, ?it/s]  8%|▊         | 227/2789 [00:00<00:01, 2129.87it/s] 15%|█▌        | 420/2789 [00:00<00:01, 2048.94it/s] 23%|██▎       | 631/2789 [00:00<00:01, 2037.32it/s] 27%|██▋       | 763/2789 [00:00<00:01, 1691.55it/s] 33%|███▎      | 916/2789 [00:00<00:01, 1585.10it/s] 40%|███▉      | 1108/2789 [00:00<00:01, 1671.24it/s] 45%|████▌     | 1258/2789 [00:00<00:00, 1546.81it/s] 52%|█████▏    | 1462/2789 [00:00<00:00, 1648.98it/s] 58%|█████▊    | 1622/2789 [00:00<00:00, 1596.33it/s] 67%|██████▋   | 1870/2789 [00:01<00:00, 1748.39it/s] 77%|███████▋  | 2137/2789 [00:01<00:00, 1896.30it/s] 84%|████████▎ | 2332/2789 [00:01<00:00, 1829.96it/s] 94%|█████████▍| 2615/2789 [00:01<00:00, 2038.83it/s]100%|██████████| 2789/2789 [00:01<00:00, 1879.28it/s]
INFO:absl:processing A11
  0%|          | 0/2789 [00:00<?, ?it/s]  6%|▌         | 167/2789 [00:00<00:01, 1661.83it/s] 14%|█▍        | 404/2789 [00:00<00:01, 1779.50it/s] 23%|██▎       | 650/2789 [00:00<00:01, 1916.93it/s] 32%|███▏      | 893/2789 [00:00<00:00, 2003.92it/s] 46%|████▋     | 1295/2789 [00:00<00:00, 2308.90it/s] 54%|█████▍    | 1518/2789 [00:00<00:00, 2036.31it/s] 62%|██████▏   | 1722/2789 [00:00<00:00, 1880.08it/s] 70%|███████   | 1953/2789 [00:00<00:00, 1969.36it/s] 77%|███████▋  | 2153/2789 [00:01<00:00, 1876.14it/s] 86%|████████▌ | 2387/2789 [00:01<00:00, 1963.73it/s] 93%|█████████▎| 2587/2789 [00:01<00:00, 1620.01it/s]100%|██████████| 2789/2789 [00:01<00:00, 1988.32it/s]
INFO:absl:processing D31
  0%|          | 0/2789 [00:00<?, ?it/s] 12%|█▏        | 343/2789 [00:00<00:00, 3324.80it/s] 22%|██▏       | 600/2789 [00:00<00:00, 3010.67it/s] 37%|███▋      | 1044/2789 [00:00<00:00, 3261.90it/s] 53%|█████▎    | 1485/2789 [00:00<00:00, 3532.82it/s] 64%|██████▎   | 1772/2789 [00:00<00:00, 2748.95it/s] 73%|███████▎  | 2034/2789 [00:00<00:00, 2633.40it/s] 85%|████████▍ | 2364/2789 [00:00<00:00, 2737.46it/s] 97%|█████████▋| 2692/2789 [00:00<00:00, 2807.35it/s]100%|██████████| 2789/2789 [00:00<00:00, 2949.87it/s]
INFO:absl:processing B15
  0%|          | 0/2789 [00:00<?, ?it/s] 13%|█▎        | 362/2789 [00:00<00:00, 3352.96it/s] 30%|██▉       | 827/2789 [00:00<00:00, 3588.61it/s] 50%|████▉     | 1383/2789 [00:00<00:00, 3911.10it/s] 69%|██████▊   | 1912/2789 [00:00<00:00, 4216.30it/s] 81%|████████▏ | 2269/2789 [00:00<00:00, 3482.80it/s] 99%|█████████▉| 2761/2789 [00:00<00:00, 3749.20it/s]100%|██████████| 2789/2789 [00:00<00:00, 4080.69it/s]
INFO:absl:processing A33
  0%|          | 0/2789 [00:00<?, ?it/s] 17%|█▋        | 480/2789 [00:00<00:00, 4491.78it/s] 47%|████▋     | 1319/2789 [00:00<00:00, 5113.34it/s] 68%|██████▊   | 1883/2789 [00:00<00:00, 5210.60it/s]100%|██████████| 2789/2789 [00:00<00:00, 7178.70it/s]
INFO:absl:processing C32
  0%|          | 0/2789 [00:00<?, ?it/s]  7%|▋         | 202/2789 [00:00<00:01, 1943.38it/s] 14%|█▎        | 381/2789 [00:00<00:01, 1886.89it/s] 23%|██▎       | 639/2789 [00:00<00:01, 2023.61it/s] 30%|███       | 841/2789 [00:00<00:00, 2022.50it/s] 36%|███▌      | 1002/2789 [00:00<00:00, 1815.43it/s] 43%|████▎     | 1196/2789 [00:00<00:00, 1789.18it/s] 49%|████▊     | 1356/2789 [00:00<00:00, 1597.23it/s] 61%|██████    | 1703/2789 [00:00<00:00, 1896.33it/s] 68%|██████▊   | 1910/2789 [00:01<00:00, 1631.62it/s] 77%|███████▋  | 2161/2789 [00:01<00:00, 1803.78it/s] 90%|████████▉ | 2505/2789 [00:01<00:00, 2077.31it/s]100%|██████████| 2789/2789 [00:01<00:00, 2087.72it/s]
INFO:absl:processing C6
  0%|          | 0/2789 [00:00<?, ?it/s] 14%|█▎        | 377/2789 [00:00<00:00, 3438.43it/s] 24%|██▍       | 683/2789 [00:00<00:00, 3247.47it/s] 36%|███▌      | 1008/2789 [00:00<00:00, 3162.31it/s] 48%|████▊     | 1348/2789 [00:00<00:00, 3122.81it/s] 57%|█████▋    | 1583/2789 [00:00<00:00, 2782.70it/s] 66%|██████▌   | 1839/2789 [00:00<00:00, 2626.67it/s] 74%|███████▍  | 2069/2789 [00:00<00:00, 2426.96it/s] 82%|████████▏ | 2292/2789 [00:00<00:00, 1953.90it/s] 94%|█████████▍| 2628/2789 [00:01<00:00, 2202.96it/s]100%|██████████| 2789/2789 [00:01<00:00, 2552.73it/s]
INFO:absl:processing B8
  0%|          | 0/2789 [00:00<?, ?it/s] 12%|█▏        | 342/2789 [00:00<00:00, 3169.61it/s] 25%|██▌       | 709/2789 [00:00<00:00, 3246.62it/s] 53%|█████▎    | 1475/2789 [00:00<00:00, 3851.31it/s] 65%|██████▍   | 1799/2789 [00:00<00:00, 3198.48it/s] 75%|███████▌  | 2095/2789 [00:00<00:00, 2962.44it/s] 85%|████████▌ | 2378/2789 [00:00<00:00, 2866.42it/s]100%|██████████| 2789/2789 [00:00<00:00, 3673.30it/s]
INFO:absl:processing C23
  0%|          | 0/2789 [00:00<?, ?it/s] 77%|███████▋  | 2146/2789 [00:00<00:00, 21148.26it/s]100%|█████████▉| 2781/2789 [00:00<00:00, 10298.40it/s]100%|██████████| 2789/2789 [00:00<00:00, 11758.09it/s]
INFO:absl:processing A34
  0%|          | 0/2789 [00:00<?, ?it/s] 34%|███▍      | 945/2789 [00:00<00:00, 9038.71it/s] 71%|███████   | 1967/2789 [00:00<00:00, 9292.70it/s] 90%|█████████ | 2511/2789 [00:00<00:00, 7445.86it/s]100%|██████████| 2789/2789 [00:00<00:00, 7850.70it/s]
INFO:absl:processing C31
  0%|          | 0/2789 [00:00<?, ?it/s]  9%|▊         | 240/2789 [00:00<00:01, 2257.73it/s] 17%|█▋        | 485/2789 [00:00<00:01, 2303.29it/s] 22%|██▏       | 613/2789 [00:00<00:01, 1815.98it/s] 29%|██▉       | 818/2789 [00:00<00:01, 1841.75it/s] 36%|███▌      | 996/2789 [00:00<00:01, 1762.80it/s] 48%|████▊     | 1342/2789 [00:00<00:00, 2064.93it/s] 56%|█████▌    | 1549/2789 [00:00<00:00, 2057.42it/s] 66%|██████▌   | 1844/2789 [00:00<00:00, 2237.49it/s] 74%|███████▍  | 2073/2789 [00:01<00:00, 1847.93it/s] 81%|████████▏ | 2273/2789 [00:01<00:00, 1618.33it/s] 88%|████████▊ | 2451/2789 [00:01<00:00, 1574.57it/s] 98%|█████████▊| 2723/2789 [00:01<00:00, 1774.60it/s]100%|██████████| 2789/2789 [00:01<00:00, 1916.36it/s]
INFO:absl:processing C8
  0%|          | 0/2789 [00:00<?, ?it/s] 19%|█▊        | 518/2789 [00:00<00:00, 4664.61it/s] 25%|██▌       | 706/2789 [00:00<00:00, 3124.19it/s] 40%|████      | 1128/2789 [00:00<00:00, 3305.09it/s] 52%|█████▏    | 1456/2789 [00:00<00:00, 3285.32it/s] 62%|██████▏   | 1726/2789 [00:00<00:00, 3056.41it/s] 78%|███████▊  | 2162/2789 [00:00<00:00, 3319.07it/s] 88%|████████▊ | 2465/2789 [00:00<00:00, 2807.75it/s]100%|██████████| 2789/2789 [00:00<00:00, 3275.98it/s]
INFO:absl:processing B2
  0%|          | 0/2789 [00:00<?, ?it/s] 19%|█▉        | 532/2789 [00:00<00:00, 4819.23it/s] 36%|███▌      | 1005/2789 [00:00<00:00, 4673.19it/s] 51%|█████     | 1426/2789 [00:00<00:00, 4522.27it/s] 66%|██████▌   | 1832/2789 [00:00<00:00, 4329.19it/s] 77%|███████▋  | 2153/2789 [00:00<00:00, 3818.13it/s] 89%|████████▉ | 2487/2789 [00:00<00:00, 3536.15it/s]100%|██████████| 2789/2789 [00:00<00:00, 4005.66it/s]
INFO:absl:processing A6
  0%|          | 0/2789 [00:00<?, ?it/s] 21%|██        | 589/2789 [00:00<00:00, 5297.10it/s] 31%|███       | 854/2789 [00:00<00:00, 3929.95it/s] 43%|████▎     | 1213/2789 [00:00<00:00, 3694.70it/s] 62%|██████▏   | 1719/2789 [00:00<00:00, 3995.72it/s] 73%|███████▎  | 2026/2789 [00:00<00:00, 3172.71it/s] 84%|████████▍ | 2336/2789 [00:00<00:00, 3097.32it/s] 94%|█████████▍| 2626/2789 [00:00<00:00, 2967.88it/s]100%|██████████| 2789/2789 [00:00<00:00, 3417.65it/s]
INFO:absl:processing B6
  0%|          | 0/2789 [00:00<?, ?it/s] 15%|█▍        | 408/2789 [00:00<00:00, 3814.50it/s] 21%|██        | 587/2789 [00:00<00:00, 2797.65it/s] 31%|███       | 862/2789 [00:00<00:00, 2715.29it/s] 44%|████▍     | 1223/2789 [00:00<00:00, 2845.56it/s] 52%|█████▏    | 1438/2789 [00:00<00:00, 2583.62it/s] 61%|██████▏   | 1710/2789 [00:00<00:00, 2594.71it/s] 70%|██████▉   | 1939/2789 [00:00<00:00, 2369.89it/s] 77%|███████▋  | 2158/2789 [00:00<00:00, 2259.68it/s] 85%|████████▌ | 2373/2789 [00:00<00:00, 2164.64it/s]100%|██████████| 2789/2789 [00:01<00:00, 2616.42it/s]
INFO:absl:processing C17
  0%|          | 0/2789 [00:00<?, ?it/s] 22%|██▏       | 617/2789 [00:00<00:00, 6009.90it/s] 39%|███▉      | 1082/2789 [00:00<00:00, 5298.34it/s] 48%|████▊     | 1333/2789 [00:00<00:00, 3756.17it/s] 64%|██████▍   | 1780/2789 [00:00<00:00, 3911.07it/s] 75%|███████▍  | 2080/2789 [00:00<00:00, 3521.33it/s] 86%|████████▌ | 2385/2789 [00:00<00:00, 3292.16it/s] 97%|█████████▋| 2711/2789 [00:00<00:00, 3205.65it/s]100%|██████████| 2789/2789 [00:00<00:00, 3588.53it/s]
INFO:absl:processing B33
  0%|          | 0/2789 [00:00<?, ?it/s] 48%|████▊     | 1338/2789 [00:00<00:00, 12286.90it/s] 67%|██████▋   | 1859/2789 [00:00<00:00, 8569.15it/s]  89%|████████▊ | 2469/2789 [00:00<00:00, 7475.97it/s]100%|██████████| 2789/2789 [00:00<00:00, 8395.99it/s]
INFO:absl:processing C20
  0%|          | 0/2789 [00:00<?, ?it/s] 42%|████▏     | 1168/2789 [00:00<00:00, 11048.64it/s] 60%|██████    | 1683/2789 [00:00<00:00, 8140.00it/s]  81%|████████  | 2252/2789 [00:00<00:00, 7195.68it/s] 97%|█████████▋| 2716/2789 [00:00<00:00, 6078.82it/s]100%|██████████| 2789/2789 [00:00<00:00, 5909.46it/s]
INFO:absl:processing C19
  0%|          | 0/2789 [00:00<?, ?it/s] 45%|████▍     | 1243/2789 [00:00<00:00, 12429.98it/s] 75%|███████▍  | 2083/2789 [00:00<00:00, 10583.30it/s] 93%|█████████▎| 2580/2789 [00:00<00:00, 7090.09it/s] 100%|██████████| 2789/2789 [00:00<00:00, 7762.93it/s]
INFO:absl:processing C13
  0%|          | 0/2789 [00:00<?, ?it/s] 22%|██▏       | 608/2789 [00:00<00:00, 5737.57it/s] 39%|███▊      | 1077/2789 [00:00<00:00, 5157.60it/s] 47%|████▋     | 1323/2789 [00:00<00:00, 3620.67it/s] 65%|██████▍   | 1811/2789 [00:00<00:00, 3877.06it/s] 76%|███████▌  | 2116/2789 [00:00<00:00, 3488.33it/s] 87%|████████▋ | 2415/2789 [00:00<00:00, 3219.70it/s] 99%|█████████▊| 2748/2789 [00:00<00:00, 3153.70it/s]100%|██████████| 2789/2789 [00:00<00:00, 3636.43it/s]
INFO:absl:processing C2
  0%|          | 0/2789 [00:00<?, ?it/s] 37%|███▋      | 1023/2789 [00:00<00:00, 9595.97it/s] 72%|███████▏  | 2012/2789 [00:00<00:00, 9519.70it/s]100%|██████████| 2789/2789 [00:00<00:00, 9037.17it/s]
INFO:absl:processing A23
  0%|          | 0/2789 [00:00<?, ?it/s] 59%|█████▉    | 1639/2789 [00:00<00:00, 14938.35it/s] 99%|█████████▉| 2772/2789 [00:00<00:00, 13170.32it/s]100%|██████████| 2789/2789 [00:00<00:00, 10663.93it/s]
INFO:absl:processing C18
  0%|          | 0/2789 [00:00<?, ?it/s] 41%|████      | 1143/2789 [00:00<00:00, 10357.47it/s] 60%|██████    | 1678/2789 [00:00<00:00, 7925.08it/s]  75%|███████▍  | 2091/2789 [00:00<00:00, 5993.29it/s] 88%|████████▊ | 2466/2789 [00:00<00:00, 4027.81it/s]100%|██████████| 2789/2789 [00:00<00:00, 5409.73it/s]
INFO:absl:processing D32
  0%|          | 0/2789 [00:00<?, ?it/s] 63%|██████▎   | 1764/2789 [00:00<00:00, 15956.87it/s]100%|██████████| 2789/2789 [00:00<00:00, 16675.41it/s]
INFO:absl:processing B32
  0%|          | 0/2789 [00:00<?, ?it/s] 31%|███       | 863/2789 [00:00<00:00, 7805.37it/s] 58%|█████▊    | 1610/2789 [00:00<00:00, 7586.26it/s] 84%|████████▎ | 2330/2789 [00:00<00:00, 7287.84it/s]100%|██████████| 2789/2789 [00:00<00:00, 5340.39it/s]
INFO:absl:processing A2
  0%|          | 0/2789 [00:00<?, ?it/s] 22%|██▏       | 623/2789 [00:00<00:00, 6070.92it/s] 44%|████▍     | 1231/2789 [00:00<00:00, 6058.73it/s] 56%|█████▌    | 1557/2789 [00:00<00:00, 4673.40it/s] 71%|███████▏  | 1992/2789 [00:00<00:00, 4570.71it/s] 90%|████████▉ | 2501/2789 [00:00<00:00, 4713.99it/s]100%|██████████| 2789/2789 [00:00<00:00, 4775.54it/s]
INFO:absl:processing A36
  0%|          | 0/2789 [00:00<?, ?it/s] 48%|████▊     | 1336/2789 [00:00<00:00, 12756.68it/s] 84%|████████▍ | 2345/2789 [00:00<00:00, 11518.73it/s]100%|██████████| 2789/2789 [00:00<00:00, 9440.12it/s] 
INFO:absl:processing A7
  0%|          | 0/2789 [00:00<?, ?it/s] 51%|█████▏    | 1430/2789 [00:00<00:00, 12924.07it/s]100%|██████████| 2789/2789 [00:00<00:00, 15657.53it/s]
INFO:absl:processing D11
  0%|          | 0/2789 [00:00<?, ?it/s] 35%|███▍      | 973/2789 [00:00<00:00, 8633.94it/s] 64%|██████▎   | 1773/2789 [00:00<00:00, 8187.02it/s] 85%|████████▍ | 2367/2789 [00:00<00:00, 7067.66it/s]100%|██████████| 2789/2789 [00:00<00:00, 6678.43it/s]
INFO:absl:processing A13
  0%|          | 0/2789 [00:00<?, ?it/s] 85%|████████▌ | 2376/2789 [00:00<00:00, 22768.36it/s]100%|██████████| 2789/2789 [00:00<00:00, 26622.41it/s]
INFO:absl:processing C4
  0%|          | 0/2789 [00:00<?, ?it/s] 77%|███████▋  | 2142/2789 [00:00<00:00, 20692.48it/s]100%|██████████| 2789/2789 [00:00<00:00, 13908.74it/s]
INFO:absl:processing A14
  0%|          | 0/2789 [00:00<?, ?it/s] 29%|██▉       | 805/2789 [00:00<00:00, 7540.73it/s] 81%|████████  | 2255/2789 [00:00<00:00, 8718.20it/s]100%|██████████| 2789/2789 [00:00<00:00, 9024.13it/s]
INFO:absl:processing B4
  0%|          | 0/2789 [00:00<?, ?it/s] 52%|█████▏    | 1443/2789 [00:00<00:00, 13012.71it/s]100%|██████████| 2789/2789 [00:00<00:00, 14376.84it/s]
INFO:absl:processing D4
  0%|          | 0/2789 [00:00<?, ?it/s] 45%|████▍     | 1243/2789 [00:00<00:00, 11366.01it/s] 96%|█████████▋| 2691/2789 [00:00<00:00, 11934.58it/s]100%|██████████| 2789/2789 [00:00<00:00, 11409.64it/s]
INFO:absl:processing B22
  0%|          | 0/2789 [00:00<?, ?it/s] 73%|███████▎  | 2038/2789 [00:00<00:00, 20104.26it/s]100%|██████████| 2789/2789 [00:00<00:00, 13989.93it/s]
INFO:absl:processing B12
  0%|          | 0/2789 [00:00<?, ?it/s] 32%|███▏      | 890/2789 [00:00<00:00, 8251.67it/s] 64%|██████▍   | 1782/2789 [00:00<00:00, 8341.73it/s] 98%|█████████▊| 2728/2789 [00:00<00:00, 8410.12it/s]100%|██████████| 2789/2789 [00:00<00:00, 8282.58it/s]
INFO:absl:processing C12
  0%|          | 0/2789 [00:00<?, ?it/s] 26%|██▋       | 737/2789 [00:00<00:00, 6872.21it/s] 45%|████▌     | 1268/2789 [00:00<00:00, 6265.53it/s] 64%|██████▍   | 1785/2789 [00:00<00:00, 5769.88it/s] 77%|███████▋  | 2142/2789 [00:00<00:00, 4044.68it/s] 92%|█████████▏| 2569/2789 [00:00<00:00, 3996.31it/s]100%|██████████| 2789/2789 [00:00<00:00, 4147.92it/s]
INFO:absl:processing D7
  0%|          | 0/2789 [00:00<?, ?it/s] 45%|████▌     | 1256/2789 [00:00<00:00, 11261.99it/s]100%|██████████| 2789/2789 [00:00<00:00, 14504.20it/s]
INFO:absl:processing C22
  0%|          | 0/2789 [00:00<?, ?it/s] 79%|███████▉  | 2198/2789 [00:00<00:00, 21253.19it/s]100%|██████████| 2789/2789 [00:00<00:00, 13030.61it/s]
INFO:absl:processing B7
  0%|          | 0/2789 [00:00<?, ?it/s] 48%|████▊     | 1337/2789 [00:00<00:00, 12013.69it/s] 78%|███████▊  | 2184/2789 [00:00<00:00, 10452.35it/s]100%|██████████| 2789/2789 [00:00<00:00, 11391.57it/s]
INFO:absl:processing B31
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 41419.83it/s]
INFO:absl:processing C7
  0%|          | 0/2789 [00:00<?, ?it/s] 58%|█████▊    | 1609/2789 [00:00<00:00, 15799.96it/s] 89%|████████▉ | 2479/2789 [00:00<00:00, 12239.87it/s]100%|██████████| 2789/2789 [00:00<00:00, 9505.50it/s] 
INFO:absl:processing B21
  0%|          | 0/2789 [00:00<?, ?it/s] 59%|█████▉    | 1644/2789 [00:00<00:00, 16107.37it/s]100%|██████████| 2789/2789 [00:00<00:00, 17768.43it/s]
INFO:absl:processing D21
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 30689.41it/s]
INFO:absl:processing C14
  0%|          | 0/2789 [00:00<?, ?it/s] 63%|██████▎   | 1765/2789 [00:00<00:00, 16924.70it/s] 99%|█████████▉| 2768/2789 [00:00<00:00, 13305.95it/s]100%|██████████| 2789/2789 [00:00<00:00, 12026.86it/s]
INFO:absl:processing A9
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 98344.77it/s]
INFO:absl:processing A35
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 69816.62it/s]
INFO:absl:processing A4
  0%|          | 0/2789 [00:00<?, ?it/s] 94%|█████████▍| 2616/2789 [00:00<00:00, 24211.15it/s]100%|██████████| 2789/2789 [00:00<00:00, 25750.28it/s]
INFO:absl:processing B34
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 2196378.87it/s]
INFO:absl:processing A5
  0%|          | 0/2789 [00:00<?, ?it/s]100%|██████████| 2789/2789 [00:00<00:00, 2386355.34it/s]
INFO:absl:finished compute cmvn, which cost 36.6371 s
INFO:absl:Successfully save cmvn file examples/asr/thchs30/data/cmvn
Fbank params:  [('channel', 1), ('cls', <class 'athena.transform.feats.fbank.Fbank'>), ('delta_delta', False), ('dither', 0.0), ('filterbank_channel_count', 40), ('frame_length', 0.01), ('global_mean', [0.0]), ('global_variance', [1.000001]), ('is_fbank', True), ('local_cmvn', False), ('lower_frequency_limit', 60), ('order', 2), ('output_type', 1), ('preEph_coeff', 0.97), ('raw_energy', 1), ('remove_dc_offset', True), ('snip_edges', 1), ('type', 'Fbank'), ('upper_frequency_limit', 0), ('window', 2), ('window_length', 0.025), ('window_type', 'povey')]
Fine-tuning
[1,0]<stderr>:INFO:absl:hparams: [('batch_size', 8), ('ckpt', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/'), ('cls', 'main'), ('dataset_builder', 'speech_recognition_dataset'), ('decode_config', {'beam_search': True, 'beam_size': 10, 'ctc_weight': 0.5, 'lm_weight': 0.7, 'lm_type': 'rnn', 'lm_path': 'examples/asr/thchs30/configs/rnnlm.json'}), ('devset_config', {'data_csv': 'examples/asr/thchs30/data/dev.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('model', 'mtl_transformer_ctc'), ('model_config', {'model': 'speech_transformer', 'model_config': {'return_encoder_output': True, 'num_filters': 512, 'd_model': 512, 'num_heads': 8, 'num_encoder_layers': 12, 'num_decoder_layers': 6, 'dff': 1280, 'rate': 0.1, 'label_smoothing_rate': 0.0, 'schedual_sampling_rate': 0.9}, 'mtl_weight': 0.5}), ('num_classes', None), ('num_data_threads', 1), ('num_epochs', 50), ('optimizer', 'warmup_adam'), ('optimizer_config', {'d_model': 512, 'warmup_steps': 25000, 'k': 1.0, 'decay_steps': 100000000, 'decay_rate': 0.1}), ('pretrained_model', None), ('solver_config', {'clip_norm': 100, 'log_interval': 10, 'enable_tf_function': True}), ('solver_gpu', [2]), ('sorta_epoch', 5), ('summary_dir', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/event'), ('testset_config', {'data_csv': 'examples/asr/thchs30/data/test.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('trainset_config', {'data_csv': 'examples/asr/thchs30/data/train.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000], 'speed_permutation': [0.9, 1.0, 1.1]})]
[1,1]<stderr>:INFO:absl:hparams: [('batch_size', 8), ('ckpt', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/'), ('cls', 'main'), ('dataset_builder', 'speech_recognition_dataset'), ('decode_config', {'beam_search': True, 'beam_size': 10, 'ctc_weight': 0.5, 'lm_weight': 0.7, 'lm_type': 'rnn', 'lm_path': 'examples/asr/thchs30/configs/rnnlm.json'}), ('devset_config', {'data_csv': 'examples/asr/thchs30/data/dev.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('model', 'mtl_transformer_ctc'), ('model_config', {'model': 'speech_transformer', 'model_config': {'return_encoder_output': True, 'num_filters': 512, 'd_model': 512, 'num_heads': 8, 'num_encoder_layers': 12, 'num_decoder_layers': 6, 'dff': 1280, 'rate': 0.1, 'label_smoothing_rate': 0.0, 'schedual_sampling_rate': 0.9}, 'mtl_weight': 0.5}), ('num_classes', None), ('num_data_threads', 1), ('num_epochs', 50), ('optimizer', 'warmup_adam'), ('optimizer_config', {'d_model': 512, 'warmup_steps': 25000, 'k': 1.0, 'decay_steps': 100000000, 'decay_rate': 0.1}), ('pretrained_model', None), ('solver_config', {'clip_norm': 100, 'log_interval': 10, 'enable_tf_function': True}), ('solver_gpu', [2]), ('sorta_epoch', 5), ('summary_dir', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/event'), ('testset_config', {'data_csv': 'examples/asr/thchs30/data/test.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('trainset_config', {'data_csv': 'examples/asr/thchs30/data/train.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000], 'speed_permutation': [0.9, 1.0, 1.1]})]
[1,1]<stderr>:2020-04-04 20:35:44.855271: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
[1,0]<stderr>:2020-04-04 20:35:44.855741: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
[1,1]<stderr>:2020-04-04 20:35:45.703021: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,0]<stderr>:2020-04-04 20:35:45.703108: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,1]<stderr>:2020-04-04 20:35:45.704070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
[1,1]<stderr>:name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
[1,1]<stderr>:pciBusID: 0000:04:01.0
[1,0]<stderr>:2020-04-04 20:35:45.704147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
[1,0]<stderr>:name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
[1,0]<stderr>:pciBusID: 0000:04:01.0
[1,1]<stderr>:2020-04-04 20:35:45.704160: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,0]<stderr>:2020-04-04 20:35:45.704248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,1]<stderr>:2020-04-04 20:35:45.705110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties: 
[1,1]<stderr>:name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
[1,1]<stderr>:pciBusID: 0000:04:02.0
[1,0]<stderr>:2020-04-04 20:35:45.705197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties: 
[1,0]<stderr>:name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
[1,0]<stderr>:pciBusID: 0000:04:02.0
[1,1]<stderr>:2020-04-04 20:35:45.705392: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.705527: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
[1,1]<stderr>:2020-04-04 20:35:45.706941: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.707039: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
[1,1]<stderr>:2020-04-04 20:35:45.708294: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.708356: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
[1,1]<stderr>:2020-04-04 20:35:45.708640: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.708694: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
[1,1]<stderr>:2020-04-04 20:35:45.710481: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.710478: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
[1,1]<stderr>:2020-04-04 20:35:45.711857: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.711818: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
[1,0]<stderr>:2020-04-04 20:35:45.711968: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /work20/luoxiaojie/cuda-10.0/lib64:/work20/luoxiaojie/kaldi/tools/liblbfgs-1.10/lib/.libs
[1,0]<stderr>:2020-04-04 20:35:45.711983: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
[1,0]<stderr>:Skipping registering GPU devices...
[1,1]<stderr>:2020-04-04 20:35:45.711985: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /work20/luoxiaojie/cuda-10.0/lib64:/work20/luoxiaojie/kaldi/tools/liblbfgs-1.10/lib/.libs
[1,1]<stderr>:2020-04-04 20:35:45.711997: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
[1,1]<stderr>:Skipping registering GPU devices...
[1,0]<stderr>:INFO:absl:hparams: [('batch_size', 8), ('ckpt', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/'), ('cls', 'main'), ('dataset_builder', 'speech_recognition_dataset'), ('decode_config', {'beam_search': True, 'beam_size': 10, 'ctc_weight': 0.5, 'lm_weight': 0.7, 'lm_type': 'rnn', 'lm_path': 'examples/asr/thchs30/configs/rnnlm.json'}), ('devset_config', {'data_csv': 'examples/asr/thchs30/data/dev.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('model', 'mtl_transformer_ctc'), ('model_config', {'model': 'speech_transformer', 'model_config': {'return_encoder_output': True, 'num_filters': 512, 'd_model': 512, 'num_heads': 8, 'num_encoder_layers': 12, 'num_decoder_layers': 6, 'dff': 1280, 'rate': 0.1, 'label_smoothing_rate': 0.0, 'schedual_sampling_rate': 0.9}, 'mtl_weight': 0.5}), ('num_classes', None), ('num_data_threads', 1), ('num_epochs', 50), ('optimizer', 'warmup_adam'), ('optimizer_config', {'d_model': 512, 'warmup_steps': 25000, 'k': 1.0, 'decay_steps': 100000000, 'decay_rate': 0.1}), ('pretrained_model', None), ('solver_config', {'clip_norm': 100, 'log_interval': 10, 'enable_tf_function': True}), ('solver_gpu', [2]), ('sorta_epoch', 5), ('summary_dir', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/event'), ('testset_config', {'data_csv': 'examples/asr/thchs30/data/test.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('trainset_config', {'data_csv': 'examples/asr/thchs30/data/train.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000], 'speed_permutation': [0.9, 1.0, 1.1]})]
[1,1]<stderr>:INFO:absl:hparams: [('batch_size', 8), ('ckpt', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/'), ('cls', 'main'), ('dataset_builder', 'speech_recognition_dataset'), ('decode_config', {'beam_search': True, 'beam_size': 10, 'ctc_weight': 0.5, 'lm_weight': 0.7, 'lm_type': 'rnn', 'lm_path': 'examples/asr/thchs30/configs/rnnlm.json'}), ('devset_config', {'data_csv': 'examples/asr/thchs30/data/dev.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('model', 'mtl_transformer_ctc'), ('model_config', {'model': 'speech_transformer', 'model_config': {'return_encoder_output': True, 'num_filters': 512, 'd_model': 512, 'num_heads': 8, 'num_encoder_layers': 12, 'num_decoder_layers': 6, 'dff': 1280, 'rate': 0.1, 'label_smoothing_rate': 0.0, 'schedual_sampling_rate': 0.9}, 'mtl_weight': 0.5}), ('num_classes', None), ('num_data_threads', 1), ('num_epochs', 50), ('optimizer', 'warmup_adam'), ('optimizer_config', {'d_model': 512, 'warmup_steps': 25000, 'k': 1.0, 'decay_steps': 100000000, 'decay_rate': 0.1}), ('pretrained_model', None), ('solver_config', {'clip_norm': 100, 'log_interval': 10, 'enable_tf_function': True}), ('solver_gpu', [2]), ('sorta_epoch', 5), ('summary_dir', 'examples/asr/thchs30/ckpts/mtl_transformer_ctc/event'), ('testset_config', {'data_csv': 'examples/asr/thchs30/data/test.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000]}), ('trainset_config', {'data_csv': 'examples/asr/thchs30/data/train.csv', 'audio_config': {'type': 'Fbank', 'filterbank_channel_count': 40}, 'cmvn_file': 'examples/asr/thchs30/data/cmvn', 'text_config': {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'}, 'input_length_range': [10, 8000], 'speed_permutation': [0.9, 1.0, 1.1]})]
[1,0]<stderr>:INFO:absl:hparams: [('audio_config', {'type': 'Fbank', 'filterbank_channel_count': 40}), ('cls', <class 'athena.data.datasets.speech_recognition.SpeechRecognitionDatasetBuilder'>), ('cmvn_file', 'examples/asr/thchs30/data/cmvn'), ('data_csv', 'examples/asr/thchs30/data/train.csv'), ('input_length_range', [10, 8000]), ('output_length_range', [1, 10000]), ('remove_unk', True), ('speed_permutation', [0.9, 1.0, 1.1]), ('text_config', {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'})]
[1,1]<stderr>:INFO:absl:hparams: [('audio_config', {'type': 'Fbank', 'filterbank_channel_count': 40}), ('cls', <class 'athena.data.datasets.speech_recognition.SpeechRecognitionDatasetBuilder'>), ('cmvn_file', 'examples/asr/thchs30/data/cmvn'), ('data_csv', 'examples/asr/thchs30/data/train.csv'), ('input_length_range', [10, 8000]), ('output_length_range', [1, 10000]), ('remove_unk', True), ('speed_permutation', [0.9, 1.0, 1.1]), ('text_config', {'type': 'vocab', 'model': 'examples/asr/thchs30/data/vocab'})]
[1,0]<stdout>:Fbank params:  [('channel', 1), ('cls', <class 'athena.transform.feats.fbank.Fbank'>), ('delta_delta', False), ('dither', 0.0), ('filterbank_channel_count', 40), ('frame_length', 0.01), ('global_mean', [0.0]), ('global_variance', [1.000001]), ('is_fbank', True), ('local_cmvn', False), ('lower_frequency_limit', 60), ('order', 2), ('output_type', 1), ('preEph_coeff', 0.97), ('raw_energy', 1), ('remove_dc_offset', True), ('snip_edges', 1), ('type', 'Fbank'), ('upper_frequency_limit', 0), ('window', 2), ('window_length', 0.025), ('window_type', 'povey')]
[1,1]<stdout>:Fbank params:  [('channel', 1), ('cls', <class 'athena.transform.feats.fbank.Fbank'>), ('delta_delta', False), ('dither', 0.0), ('filterbank_channel_count', 40), ('frame_length', 0.01), ('global_mean', [0.0]), ('global_variance', [1.000001]), ('is_fbank', True), ('local_cmvn', False), ('lower_frequency_limit', 60), ('order', 2), ('output_type', 1), ('preEph_coeff', 0.97), ('raw_energy', 1), ('remove_dc_offset', True), ('snip_edges', 1), ('type', 'Fbank'), ('upper_frequency_limit', 0), ('window', 2), ('window_length', 0.025), ('window_type', 'povey')]
[1,0]<stderr>:INFO:absl:Successfully load cmvn file examples/asr/thchs30/data/cmvn
[1,0]<stderr>:INFO:absl:Loading data from examples/asr/thchs30/data/train.csv
[1,1]<stderr>:INFO:absl:Successfully load cmvn file examples/asr/thchs30/data/cmvn
[1,1]<stderr>:INFO:absl:Loading data from examples/asr/thchs30/data/train.csv
[1,0]<stderr>:INFO:absl:perform speed permutation
[1,1]<stderr>:INFO:absl:perform speed permutation
[1,0]<stderr>:2020-04-04 20:35:46.081693: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
[1,1]<stderr>:2020-04-04 20:35:46.082363: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
[1,0]<stderr>:2020-04-04 20:35:46.089218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294605000 Hz
[1,0]<stderr>:2020-04-04 20:35:46.089913: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5619bcea2790 executing computations on platform Host. Devices:
[1,0]<stderr>:2020-04-04 20:35:46.089939: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
[1,1]<stderr>:2020-04-04 20:35:46.090702: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294605000 Hz
[1,1]<stderr>:2020-04-04 20:35:46.091615: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ad9c0027a0 executing computations on platform Host. Devices:
[1,1]<stderr>:2020-04-04 20:35:46.091661: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
[1,1]<stderr>:2020-04-04 20:35:46.571259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,0]<stderr>:2020-04-04 20:35:46.577692: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,1]<stderr>:2020-04-04 20:35:46.577770: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,1]<stderr>:2020-04-04 20:35:46.579744: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ad9c045800 executing computations on platform CUDA. Devices:
[1,1]<stderr>:2020-04-04 20:35:46.579833: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
[1,1]<stderr>:2020-04-04 20:35:46.579854: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (1): Tesla V100-PCIE-16GB, Compute Capability 7.0
[1,1]<stderr>:2020-04-04 20:35:46.580394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
[1,1]<stderr>:2020-04-04 20:35:46.580425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
[1,0]<stderr>:2020-04-04 20:35:46.582014: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1006] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
[1,0]<stderr>:2020-04-04 20:35:46.582685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5619bcee57f0 executing computations on platform CUDA. Devices:
[1,0]<stderr>:2020-04-04 20:35:46.582706: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Tesla V100-PCIE-16GB, Compute Capability 7.0
[1,0]<stderr>:2020-04-04 20:35:46.582712: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (1): Tesla V100-PCIE-16GB, Compute Capability 7.0
[1,0]<stderr>:2020-04-04 20:35:46.583011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
[1,0]<stderr>:2020-04-04 20:35:46.583025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
[1,0]<stdout>:Model: "x_net"
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:Layer (type)                 Output Shape              Param #   
[1,0]<stdout>:=================================================================
[1,0]<stdout>:input_1 (InputLayer)         [(None, None, 40, 1)]     0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:conv2d (Conv2D)              (None, None, 20, 512)     4608      
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:batch_normalization (BatchNo (None, None, 20, 512)     2048      
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:tf_op_layer_Relu6 (TensorFlo [(None, None, 20, 512)]   0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:conv2d_1 (Conv2D)            (None, None, 10, 512)     2359296   
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:batch_normalization_1 (Batch (None, None, 10, 512)     2048      
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:tf_op_layer_Relu6_1 (TensorF [(None, None, 10, 512)]   0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:reshape (Reshape)            (None, None, 5120)        0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:dense (Dense)                (None, None, 512)         2621952   
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:positional_encoding (Positio (None, None, 512)         0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:dropout (Dropout)            (None, None, 512)         0         
[1,0]<stdout>:=================================================================
[1,0]<stdout>:Total params: 4,989,952
[1,0]<stdout>:Trainable params: 4,987,904
[1,0]<stdout>:Non-trainable params: 2,048
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:None
[1,1]<stdout>:Model: "x_net"
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:Layer (type)                 Output Shape              Param #   
[1,1]<stdout>:=================================================================
[1,1]<stdout>:input_1 (InputLayer)         [(None, None, 40, 1)]     0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:conv2d (Conv2D)              (None, None, 20, 512)     4608      
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:batch_normalization (BatchNo (None, None, 20, 512)     2048      
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:tf_op_layer_Relu6 (TensorFlo [(None, None, 20, 512)]   0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:conv2d_1 (Conv2D)            (None, None, 10, 512)     2359296   
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:batch_normalization_1 (Batch (None, None, 10, 512)     2048      
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:tf_op_layer_Relu6_1 (TensorF [(None, None, 10, 512)]   0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:reshape (Reshape)            (None, None, 5120)        0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:dense (Dense)                (None, None, 512)         2621952   
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:positional_encoding (Positio (None, None, 512)         0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:dropout (Dropout)            (None, None, 512)         0         
[1,1]<stdout>:=================================================================
[1,1]<stdout>:Total params: 4,989,952
[1,1]<stdout>:Trainable params: 4,987,904
[1,1]<stdout>:Non-trainable params: 2,048
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:None
[1,0]<stdout>:Model: "y_net"
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:Layer (type)                 Output Shape              Param #   
[1,0]<stdout>:=================================================================
[1,0]<stdout>:input_2 (InputLayer)         [(None, None)]            0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:embedding (Embedding)        (None, None, 512)         183296    
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:positional_encoding_1 (Posit (None, None, 512)         0         
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:dropout_1 (Dropout)          (None, None, 512)         0         
[1,0]<stdout>:=================================================================
[1,0]<stdout>:Total params: 183,296
[1,0]<stdout>:Trainable params: 183,296
[1,0]<stdout>:Non-trainable params: 0
[1,0]<stdout>:_________________________________________________________________
[1,0]<stdout>:None
[1,1]<stdout>:Model: "y_net"
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:Layer (type)                 Output Shape              Param #   
[1,1]<stdout>:=================================================================
[1,1]<stdout>:input_2 (InputLayer)         [(None, None)]            0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:embedding (Embedding)        (None, None, 512)         183296    
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:positional_encoding_1 (Posit (None, None, 512)         0         
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:dropout_1 (Dropout)          (None, None, 512)         0         
[1,1]<stdout>:=================================================================
[1,1]<stdout>:Total params: 183,296
[1,1]<stdout>:Trainable params: 183,296
[1,1]<stdout>:Non-trainable params: 0
[1,1]<stdout>:_________________________________________________________________
[1,1]<stdout>:None
[1,0]<stderr>:INFO:absl:trying to restore from : examples/asr/thchs30/ckpts/mtl_transformer_ctc/
[1,1]<stderr>:INFO:absl:trying to restore from : examples/asr/thchs30/ckpts/mtl_transformer_ctc/
[1,1]<stderr>:Traceback (most recent call last):
[1,1]<stderr>:  File "athena/horovod_main.py", line 115, in <module>
[1,1]<stderr>:    train(json_file, HorovodSolver, hvd.size(), hvd.rank())
[1,1]<stderr>:  File "/work20/luoxiaojie/athena/athena/main.py", line 117, in train
[1,1]<stderr>:    p, model, optimizer, checkpointer = build_model_from_jsonfile(jsonfile)
[1,1]<stderr>:  File "/work20/luoxiaojie/athena/athena/main.py", line 104, in build_model_from_jsonfile
[1,1]<stderr>:    dataset = dataset_builder.as_dataset(p.batch_size)
[1,1]<stderr>:  File "/work20/luoxiaojie/athena/athena/data/datasets/base.py", line 105, in as_dataset
[1,1]<stderr>:    return data_loader(self, batch_size, num_threads)
[1,1]<stderr>:  File "/work20/luoxiaojie/athena/athena/data/datasets/base.py", line 30, in data_loader
[1,1]<stderr>:    raise ValueError("num samples is empty")
[1,1]<stderr>:ValueError: num samples is empty
[1,0]<stderr>:Traceback (most recent call last):
[1,0]<stderr>:  File "athena/horovod_main.py", line 115, in <module>
[1,0]<stderr>:    train(json_file, HorovodSolver, hvd.size(), hvd.rank())
[1,0]<stderr>:  File "/work20/luoxiaojie/athena/athena/main.py", line 117, in train
[1,0]<stderr>:    p, model, optimizer, checkpointer = build_model_from_jsonfile(jsonfile)
[1,0]<stderr>:  File "/work20/luoxiaojie/athena/athena/main.py", line 104, in build_model_from_jsonfile
[1,0]<stderr>:    dataset = dataset_builder.as_dataset(p.batch_size)
[1,0]<stderr>:  File "/work20/luoxiaojie/athena/athena/data/datasets/base.py", line 105, in as_dataset
[1,0]<stderr>:    return data_loader(self, batch_size, num_threads)
[1,0]<stderr>:  File "/work20/luoxiaojie/athena/athena/data/datasets/base.py", line 30, in data_loader
[1,0]<stderr>:    raise ValueError("num samples is empty")
[1,0]<stderr>:ValueError: num samples is empty
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[33777,1],1]
  Exit code:    1
--------------------------------------------------------------------------
